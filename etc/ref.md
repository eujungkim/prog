### MSA Outer
#### API Gateway
모든 API 요청의 단일 접점으로 공통처리, Mediation, Aggregation 기능을 지원
- 도입 목적 : API 일원화, 공통 기능 처리(프론트와 백엔드 매핑, 로깅 처리, BFF 패턴 구현), 요청 변환
- 설계시 고려 사항 : 인증/인가(API 토큰 구현), 레거시 솔루션 연계, 유입량 제어
- 최근 추세 : Containerized (PaaS 내에 구축하여 SPOF 방지)
#### Service Mesh
확장성을 지원하는 컨테이너 간 서비스를 손쉽게 discovery 할 수 있도록 지원하는 영역. 
서비스 전달 비율을 조율하여 다양한 배포 방식와 장애를 차단하는 기능을 지원
- 도입 목적 : 서비스 탐색, 장애 전파 차단, 배포 전략(서비스에 대한 유입량 조절을 통해 A/B, canary 구현)
- 설계시 고려 사항 : 서비스 디스커버리, Lock in, Metric 수집 기능(중복 적재 유의)
- 최근 추세 : 고유 기능의 확장 (API Gateway와의 기능 중복에 의한 역할 분리)
#### Container Management
오케스트레이션을 지원하며 서비스의 라이프사이클을 관리하는 영역
- 도입 목적 : 오케스트레이션, **라이프사이클 관리**, 리소스 모니터링
- 설계시 고려 사항 : Hybrid Cloud, Cluster 배치, Echo System 지원(Telemetry, Service Mesh, CI/CD 기능 제공 범위 검증)
- 최근 추세 : 플랫폼의 안정성 확대(성능과 안정성)
#### Backing Service
데이터를 저장하거나 서비스에 종속되지 않은 데이터에 대해 안정적으로 복제하는 환경을 제공하는 영역(MQ, Cache, DB 등)으로 비동기/캐시 설계, 데이터 동기화 방식을 설계
- 도입 목정 : 약결합 구조, 분산 데이터 처리(데이터 순서 보장, 데이터 복제 및 동기화), 탄력적인 확장
- 설계 시 고려사항 : 비동기/캐시 선정, 데이터베이스 타입, 데이터 동기화 설계
- 최근 추세 : 비지니스 관려 (프론트엔드와 직접 연결되는 구조, Kafka/Redis API를 활용하여 비지니스 코드 확장)
#### CI/CD Automation
서비스 출시를 앞당길 수 있는 핵심 영역으로 고객의 pain point가 가장 많이 도출되는 영역
- 도입 목적 : 신속한 출시(소스코드 품질 관리, 테스트 자동화를 포함한 자동화 구축), 소스코드 품질 향상, 테스트 자동화
- 설계시 고려사항 : 레거시 솔루션 연계, 긴급 배포/롤백, 빌드/배포 시간 단축(사전 점검 방식 구현)
- 최근 추세 : 멀티 형상관리 연계 (Enterprise향 형상관리)
#### Telemetry
운영 안정성 측면에서 서비스의 흐름을 추적하고 통합하는 영역으로, 수집된 데이터를 어떻게 활용할 것인가에서 접근 필요
- 도입 목적 : 통합 대시 보드(분산된 서비스의 데이터를 통합적으로 관리, E2E/APM/SMS/CMP 등), 통합 로깅/추적, 자원 모니터링
- 설계시 고려사항 : 수집 대상, 방식, 컨테이너 적합 솔루션, 알림 처리 설계(장애 발생에 대해 빠른 인지 및 선 대응 환경 구성)
- 최근 추세 : 통합 유지 관리(CMP를 통한 운영환경 부담 감소)
#### Backing Service(MQ) 및 CQRS 패턴 활용 사례
- 분산 데이터 환경에 대한 설계 기준을 세우는 것은 MSA의 성패를 결정할 정도로 중요한 요소
- 유사 서비스 간 공통 DB 계정 사용 (성능, 복잡도 감소)
- 배치 처리를 위한 DB to DB 복제 구성
- 서로 다른 서비스 간 JSON 처리
- 조회 성능 향상을 위한 CQRS 패턴 설계
- 배포빈도와 독립성이 높은 서비스는 단일 DB
- 1Service-1DataSource 기본 정책에 상호 API 통신
### 기타 주요 고려 사항
-JWT 토큰을 이용한 검증 요청 및 검증 결과 리턴(사용자 정보), 인증 정보를 rest 전문 헤더에 추가하여 api 호출
- swagger를 이용한 api 명세 제공, api 권한 관리
- 미인증자 접근 통제 정책(원칙) 정의
- JPA
- Session Clustering
- 업무 요건(특성)을 고려한 솔루션 검토/적용

### CQRS
- CQRS(Command Query Responsibility Segregation)
- 명령(Command)와 조회(Query)를 분리하는 패턴
- 명령(CUD) 모델과 조회(R) 모델을 사용한다. 두 모델을 서로 다른 스키마와 데이터 저장소를 사용할 수 있다.
- 성능 분석 대상
  - 서비스 호출 빈도에 따른 서비스 활용도
  - 반복 호출되는 SQL을 확인하여 CQRS, 캐싱 적용 대상이 있는지
- CQRS Write-Thought 패턴
  - 데이터를 추가하거나 업데이트할 때 DB와 NoSQL DB(Redis 등)에 동시에 반영한다.
  - 데이터 조회시 DB는 사용하지 않고 NoSQL DB만 사용한다.
  - 장점
    - Read Data를 활용하여 DB 부하 감소
    - NoSQL DB를 활용하여 조회 성능 개선
    - RDB 제어권을 어플리케이션에서 처리 가능
  - 단점
    - 데이터가 변경될 때마다 CUD가 2번 발생
    - 조회시 NoSQL DB Miss가 발생하면 이를 보상하는 것이 힘들다 (다시 DB에서 조회하여 NoSQL DB에 쓰기 작업을 해야 함)

### 컴포저블 어플리케이션
- 모듈성, 자주성, 디스커버리, 오케스트레이션 원칙을 기반으로 재활용 가능한 비지니스 기능(PBC)을 유연하고 신속하게 조립하여 비지니스 변화 속도에 민첩하게 대응하는 응용 프로그램 개발 기술
- PBC (Packaged Business Capability)
  - 비지니스 사용자가 인식할 수 있는 잘 정의된 비지니스 기능을 나타내는 캡슐화된 소프트웨어 구성요소
  - 컴포넌트 독립성을 최대화하는 모듈성과 컴포넌트 내부 무결성을 통해 변경, 교체에 자유로운 자율성이 중요시 됨
- 4대 핵심 설계 원칙
  - 오케스트레이션 : 어플리케이션 재구성이나 프로세스를 형성하기 위한 구성 요소 간의 상호 작용 규정 및 조율
  - 디스커버리 : 설계에 필요한 컴포넌트 검색 및 관련 정보 제공 - 가이드, 추적, 보안 변경 사항 등
  - 모듈성 : 업무 도메인을 관리 가능한 구성 요소로 분할 - 확장성 확보 및 변경 사항 제어
  - 자주성 : 컴포넌트 간의 종속성/의존성 최소화 - 변경 무결성 유지
- 컴포저블 어플리케이션 vs MSA : IT 기술셋이 유사하며 상호 기술 혁신 성과가 공유됨
  - 컴포저블 어플리케이션
    - 비지니스 기능의 재활용성을 설계 목표로 함
    - 기업 비지니스 어플리케이션의 미래, 유사한 컴포넌트의 재활용 가능성 높음
    - 예) 빠른 프로토타이핑, SM성 SI, 기업을 위한 빠른 비지니스 기능 도입 (Industrial Cloud)
  - MSA
    - MS 단위를 비지니스 도메인 별로 분리하는 것을 권장
    - 신규 구축 프로젝트, SaaS 서비스 개발, 플랫폼 서비스 사업
    - 안정적 DX / B2C 서비스를 위한 필수 기반 아키텍처
    - 예) 새로운 차별화 서비스를 개발하는 스타트업, 넷플릭스 서비스와 같은 유니크 서비스 구축 프로젝트
  - Swagger(REST API Documentation Tool), Data Hub(Metadata Management)

### 빅데이터 관련 솔루션
#### 작업관리
##### Airflow
- Web UI 기반에서 파이썬 코드로 ETL 작업을 자동화하고 워크플로우를 작성해서 스케쥴링 및 모니터링 가능
- 클라우드(AWS, GCP, Azure) 환경을 통해 관리형 Airflow를 쉽고 빠르게 구현 가능
#### 분산 컴퓨팅
##### EMR
- 하둡 에코 시스템 기반 다양한 어플리케이션(Spark, MapReduce, Presto 등)의 구성으로 대용량 데이터의 분산 처리에 활용
- 다양한 어플리케이션 기반 데이터의 처리와 상세한 설정과 관리 기반의 분산 처리 환경이 필요할 경우 사용
- EMR Cluster에서 수행되는 Job에 대한 스케쥴링과 워크플로우 구현을 위해 별도의 서비스(Airflow 등) 필요
##### Glue
- 다양한 데이터소스(GCP Bigquery, RDS, AWS Redshift 등)에 대한 대용량 데이터 분산 처리에 활용
- AWS Glue Studio를 통한 GUI로 비주얼 ETL 작업을 지원하며 온디멘드 방식의 저렴한 비용으로 구성 가능
- 완전 관리현 서비스로 등록한 Job에 대한 크리거링(이벤트, 타임 등)과 Workflow 구현이 가능
#### 저장
##### Redshift
- DW에 특화된 정형 레포트/BI 서비스가 가능한 DW 전용 DB로 대량의 데이터 저장에 적합
- 관계형 데이터베이스를 지원하며 페타바이트에 이르는 다양한 규모의 데이터에 빠른 쿼리 실행이 가능
- AWS 서비스(EMR, Sagemaker, Glue 등)와 통합하여 전체 분석 Workflow 구현이 가능
##### S3
- AWS EBS 및 데이터베이스 대비 저렴한 비용으로 대량의 데이터(파일) 저장에 적합
- 다양한 형태의 원천 데이터에 대한 데이터 수집, 처리, 분석 서비스의 통합적인 데이터 저장소스로 활용 가능
- AWS Glue Catalog를 통해 파일 데이터를 메타화하고 이를 다양한 서비스에서 엑세스 가능
#### 고려 사항
- 차등적 권한 부여, 부여된 권한 내에서 자유롭게 데이터 조회

### 비동기 메세지 통신
- 비동기 메세지 통신
  - 서비스 간의 메세지를 비동기 방식으로 주고 받는 통신 (A에서 B 호출시 B의 응답을 기다리지 않고 처리)
  - 응답을 기다리지 않고 이벤트에 반응한다는 의미로 이벤트 기반 아키텍처라고 부름
  - 이벤트 기반 아키텍처 : MSA와 같은 분산시스템 구조 하에 이벤트를 생성 및 발생(publish)하고 해당 이벤트를 수신자가 구독(subscribe)하여 이벤트 처리
- 브로커 기반 비동기 메세지 통신
  - 서비스 사이에 브로커 존재
  - 장점 : loose coupling(느슨한 결합)으로 상호의존성 최소화(독립성, 지속성), 유연한 커뮤니케이션
  - 단점 : 추가 운영 인프라 설치 구성, 유지 관리 필요, 성능에 대한 병목
  - 

### design pattern
- 어댑터 패턴(Adapter Pattern)
  - 호출당하는 쪽의 메소드를 호출하는 쪽의 코드에 대응하도록 중간에 변환기를 통해 호출하는 패턴
  - 다양한 DB시스템을 공통의 인터페이스인 JDBC를 이용해 조작
- 프록시 패턴(Proxy Pattern)
  - 제어 흐름을 조정하기 위한 목적으로 중간에 대리자를 두는 패턴
- 데코레이터 패턴(Decorator Pattern)
  - 메소드 호출의 반환값에 변화를 주기 위해 중간에 장식자를 두는 패턴
- 싱글톤 패턴(Singleton Pattern)
  - 클래스의 인스턴스, 즉 객체를 하나만 만들어 사용하는 패턴
  - 커넥션 풀, 스레드 풀, 디바이스 설정 객체등과 같은 경우 인스턴스를 여러 개 만들게 되면 불필요한 자원을 사용하게 되고, 또 프로그램이 예상하지 못한 결과를 낳을 수 있다.
- 템플릿 메소드 패턴(Template Method Pattern)
  - 상위 클래스의 견본 메소드에서 하위 클래스가 오버라이딩한 메소드를 호출하는 패턴
  - 상위 클래스에 공통 로직을 수행하는 템플릿 메소드와 하위 클래스에 오버라이딩을 강제하는 추상메소드 또는 선택적으로 오버라이딩할 수 있는 훅 메소드를 두는 패턴
- 팩토리 메소드 패턴(Factory Method Pattern)
  - 오버라이드된 메소드가 객체를 반환하는 패턴
  - 하위 클래스에서 팩토리 메소드를 오버라이딩해서 객체를 반환
- 전략 패턴(Strategy Pattern)
  - 클라이언트가 전략을 생성해 전략을 실행할 컨텍스트에 주입하는 패턴
- 옵저버 패턴(Observer Pattern)
  - 변화가 일어났을 때, 미리 등록된 다른 클래스에 통보해주는 패턴을 구현한 것. event listner가 대표적인 사용 예이다.
- 파사드 패턴(Facade Pattern)
  - 여러개의 객체와 실제 사용하는 서브 객체 사이에 복잡한 의존관계가 있을 때, 중간에 facade라는 객체를 두고, 여기서 제공하는 interface만을 활용하여 기능을 사용하는 방식

### 참고
Google Cloud Pub/Sub
https://cloud.google.com/pubsub/docs/overview?hl=ko

클라우드 디자인 패턴
https://learn.microsoft.com/ko-kr/azure/architecture/patterns/

확장 가능하고 복원력이 우수한 앱 패턴
https://cloud.google.com/architecture/scalable-and-resilient-apps?hl=ko

AWS Well-Architected Framework
https://docs.aws.amazon.com/ko_kr/wellarchitected/latest/framework/welcome.html

SW 아키텍처
http://www.jidum.com/jidums/view.do?jidumId=304

소프트웨어 디자인 패턴
https://ko.wikipedia.org/wiki/%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4_%EB%94%94%EC%9E%90%EC%9D%B8_%ED%8C%A8%ED%84%B4
